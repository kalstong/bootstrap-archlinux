# Based on https://aur.archlinux.org/packages/msodbcsql
# -----------------------------------------------------

pkgname=mssql-odbc
pkgname_source=msodbcsql
pkgname_sufix=18
pkgver=18.1.1.1
pkgrel=1
pkgdesc="Microsoft® ODBC Driver 18 for SQL Server®"
arch=('x86_64')
url="https://packages.microsoft.com/rhel/8/prod/"
license=('custom')
depends=('unixodbc' 'krb5' 'curl')
options=('!strip')
source=(https://packages.microsoft.com/rhel/8/prod/${pkgname_source}${pkgname_sufix}-${pkgver}-1.x86_64.rpm)
sha512sums=('81d2bcee1adb8ebf01532da241fae2d4456145377e39ab60efaebfe79049f71c3e71eb040862cd32262ad91b53dc570b6d55895068686c8dc4a63e133d45b061')
install=msodbcsql.install

package() {
	install -Dm0644 usr/share/doc/msodbcsql18/RELEASE_NOTES "$pkgdir"/usr/share/doc/$pkgname_source/RELEASE_NOTES
	install -Dm0644 usr/share/doc/msodbcsql18/LICENSE.txt "$pkgdir"/usr/share/licenses/$pkgname_source/LICENSE.txt
	mv opt "$pkgdir"

	mv "$pkgdir"/opt/microsoft/${pkgname_source}{18,}

	cd "$pkgdir"/opt/microsoft/${pkgname_source}
	sed "s/${pkgname_source}${pkgname_sufix}/${pkgname_source}/g" -i etc/odbcinst.ini
}
